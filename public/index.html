<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"
          integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u"
          crossorigin="anonymous">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css"
          integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp"
          crossorigin="anonymous">

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"
            integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
            crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-1.10.2.js"></script>
    <script>
        $(document).ready(function () {
            $.getJSON("get-data", function (data) {
                var items = [];
                items.push('<thead><><tr><th>id</th><th>Title</th><th>Description</th><th>Category</th>' +
                    '<th>Subcategory</th><th>Price</th><th>Image</th><th>Show</th><th>Meta</th></tr></thead>');
                $.each(data, function (key, val) {
                    items.push('<tr class="db-item" id="' + key + '"><td class="item-key">' +
                        val._id + '</td><td class="item-title">' + val.title + '</td><td class="item-description">'
                        + val.description + '</td><td class="item-category">' + val.category +
                        '</td><td class="item-subcategory">' + val.subcategory + '</td><td class="item-price">'
                        + val.price + '</td><td class="item-img">' + val.img + '</td><td class="item-show">'
                        + val.show + '</td><td class="item-meta">' + val.meta + '</td></tr>');
                });

                $('<table/>', {
                    'id': 'find-table',
                    'class': 'table get-data-table',
                    html: items.join('')
                }).appendTo('#get-data');
            });

            $("#insert").click(function () {
                $("#func-menu").prop("action", "/insert-data");
                $("#_id").prop("disabled",true);
                document.getElementById('_id').value = "";
            });

            $("#update").click(function () {
                $("#func-menu").prop("action", "/update-data");
                $("#_id").prop("disabled",false);
            });

            $("#delete").click(function () {
                $("#func-menu").prop("action", "/delete-data");
                $("#_id").prop("disabled",false);
            });

            $("#func-find").click(function () {
                    var req;
                        switch ($(this).val()){
                            case "find":
                                req = "get-data";
                                break;
                            case "find-by-title":
                                req = "/findByTitle?title=" + $(".find").val();
                                break;
                            case "find-by-category":
                                req = "/findByCategory?category=" + $(".find").val();
                                break;
                        }
                            $.getJSON(req, function (data) {
                                console.log(data);
                                var items = [];
                                items.push('<thead><tr><th>id</th><th>Title</th><th>Description</th><th>Category</th>' +
                                    '<th>Subcategory</th><th>Price</th><th>Image</th><th>Show</th><th>Meta</th></tr></thead>');
                                $.each(data, function (key, val) {
                                    items.push('<tr class="db-item" id="' + key + '"><td class="item-key">' + val._id +
                                        '</td><td class="item-title">' + val.title + '</td><td class="item-description">'
                                        + val.description + '</td><td class="item-category">' + val.category +
                                        '</td><td class="item-subcategory">' + val.subcategory + '</td><td class="item-price">'
                                        + val.price + '</td><td class="item-img">' + val.img + '</td><td class="item-show">'
                                        + val.show + '</td><td class="item-meta">' + val.meta + '</td></tr>');
                                });
                                $('#find-table').remove();
                                $('<table/>', {
                                    'id' : 'find-table',
                                    'class': 'table get-data-table',
                                    html: items.join('')
                                }).appendTo('#get-data');
                            });
                });

            $("#categoryUpdate").click(function () {
                $("#update-category").prop("action", "/update-category");
            });

            $("#subcategoryUpdate").click(function () {
                $("#update-category").prop("action","/update-subcategory");
            });

            $("#_id").on("input", function () {
                $.getJSON("auto-correct?id=" + $("#_id").val(),function (data) {
                    document.getElementById('title').value  = data.title;
                    document.getElementById('description').value = data.description;
                    document.getElementById('category').value  = data.category;
                    document.getElementById('subcategory').value  = data.subcategory;
                    document.getElementById('price').value  = data.price;
                    document.getElementById('img').value  = data.img;
                    document.getElementById('show').value  = data.show;
                    document.getElementById('meta').value  = data.meta;
                });
            })
        });
</script>

    <title>Admin</title>
</head>
<body>
<div class="text-primary text-center">
    <h1>Admin Panel</h1>
</div>
    <div class="container-fluid">
        <div class="row">
            <div class="col-xs-4">
                    <form id="func-menu" action="/insert-data" method="post" class="well form-search">
                        <div class="input">
                            <label for="_id">id</label>
                            <input type="text" class="form-control" id="_id" name="_id" disabled>
                        </div>
                        <div class="input">
                            <label for="title">Title</label>
                            <input type="text" class="form-control" id="title" name="title">
                        </div>
                        <div class="input">
                            <label for="description">Description</label>
                            <input type="text" class="form-control" id="description" name="description">
                        </div>
                        <div class="input">
                            <label for="category">Category</label>
                            <input type="text" class="form-control" id="category" name="category">
                        </div>
                        <div class="input">
                            <label for="subcategory">Subcategory</label>
                            <input type="text" class="form-control" id="subcategory" name="subcategory">
                        </div>
                        <div class="input">
                            <label for="price">Price</label>
                            <input type="text" class="form-control" id="price" name="price">
                        </div>
                        <div class="input">
                            <label for="img">ImageName</label>
                            <input type="text" class="form-control" id="img" name="img">
                        </div>
                        <div class="checkbox">
                            <label for="show"><input type="checkbox" id="show" name="show" checked>Show</label>
                        </div>
                        <div class="input">
                            <label for="meta">Meta</label>
                            <input type="text" class="form-control" id="meta" name="meta">
                        </div>
                        <div class="radio">
                            <label for="insert"><input type="radio" id="insert" name="action" checked>Insert</label>
                        </div>
                        <div class="radio">
                            <label for="update"><input type="radio" id="update" name="action">Update</label>
                        </div>
                        <div class="radio">
                            <label for="delete"><input type="radio" id="delete" name="action">Delete</label>
                        </div>
                        <!--<input id="searchTitle" type="text" class="input-medium search-query">-->
                        <button id="done" type="submit" name="action" class="btn btn-primary">Done</button>
                    </form>
            </div>
            <div class="col-xs-8">
                <form class="well">
                    <div id="get-data">
                    </div>
                    <div class="input">
                        <div class="form-group">
                            <input type="text" id="find" class="find form-control" placeholder="Search">
                        </div>
                    <div class="form-group">
                        <select id="func-find" class="form-control">
                            <option value="find">Find All</option>
                            <option value="find-by-title">Find By Title</option>
                            <option value="find-by-category">Find By Category</option>
                        </select>
                    </div>
                    </div>
                </form>
            </div>
        </div>
        <div class="row">
            <div class="col-xs-4">
                <h3>Update Category</h3>
                <form id="update-category" action="/update-category" method="post" class="well form-search">
                    <div class="input">
                        <label for="lastCategory">Previous Category</label>
                        <input type="text" class="form-control" id="lastCategory" name="category">
                        <label for="newCategory">New Category</label>
                        <input type="text" class="form-control" id="newCategory" name="category">
                    </div>
                    <div class="radio">
                        <label for="categoryUpdate"><input type="radio" id="categoryUpdate" name="action" checked>Category</label>
                    </div>
                    <div class="radio">
                        <label for="subcategoryUpdate"><input type="radio" id="subcategoryUpdate" name="action">Subcategory</label>
                    </div>
                    <button id="doneUpdate" type="submit" name="action" class="btn btn-primary">Done</button>
                </form>
            </div>
        </div>
    </div>
</body>
</html>